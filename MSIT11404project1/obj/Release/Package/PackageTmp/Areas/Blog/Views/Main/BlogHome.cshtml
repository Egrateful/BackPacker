@model IEnumerable<MSIT11404project1.Areas.Blog.BlogViewModel.BlogHomeVM>


@{
    ViewBag.Title = "BlogHome";
    Layout = "~/Views/Shared/_LayoutPro.cshtml";
}

@section Style{
<link href="~/jquery-ui-1.12.1.custom/jquery-ui.css" rel="stylesheet" />
<link href="~/Areas/Blog/hover-min.css" rel="stylesheet" />
    <style>
       
        .ShowDivBG {
        width:100%;
        height:100%;
        background:no-repeat center center;
        background-size:cover;
        }
        .allPage {
        margin:0px 130px;
        
        }
        .c2 a {
        color:black;
        font-size:1.2em;
        text-decoration:none;
        }
         .docs  {
        height:360px;
        width:275px;
        padding:5px;
        margin:10px;
        border: solid #808080 1px;
        border-radius:5px;
        color:black;
        background-color:rgba(255, 255, 255, 0.8)
        }
         .docs:hover {
                    border: solid #ffee34 1.5px;
                   background-color:rgb(255, 255, 255)
            }
            .docs:active {
            color:aquamarine;
            }
                 .BestDoc {
        height:500px;
        background:no-repeat center center;
        background-size:cover;
        }
        .BDTs {
            list-style-type:none;
        }
        .BDtitle {
            height:100px;
            font-size:2em;
            width:100%;
            background-color:rgba(255, 255, 255, 0.60)
        }
        .BDa {
        color:black;
        }
            .BDa:hover {
            color:green;
            }
        .BlogFunc {
        background-color:rgba(255, 255, 255, 0.70);
        border:1px #c18d00 solid;
            border-radius:10px;
            margin-left:25px;
            padding:0 25px 5px 25px;
            height:500px;
        }
        .Ncheck {
          background-color:rgba(255, 219, 103, 0.4);
          border:1px rgba(0, 0, 0, 0) solid;
          color:#000000;
         margin:5px 0;
        }
        .Ycheck {
          background-color:rgba(255, 150, 103, 1);
          border:1px #f7ff95 solid;
          color:#000000;
          margin:5px 0;
        }
        .ByActUser {
        background-color:rgba(255, 255, 255, 0.70);
        }
        .tag1 {
            top:150px;
            left:10px;
            position:absolute;
            z-index:10;
            background-color:#ffd800;
            border:1px white solid;
            border-radius:2px;
            padding:1px;
        }
        .tag2 {
            top:177px;
            left:10px;
            position:absolute;
            z-index:10;
            background-color:#ffd800;
            border:1px white solid;
            border-radius:2px;
            padding:1px;
        }
        .tabsDiv {
         height:250px;
         background-color:rgba(255, 216, 0, 0.3);
         margin:0 5px 0 0;
         width:24%;
         border:1px #bb4e00 solid;
         border-radius:5px;
        }
            .tabsDiv h5 {
             display : inline-block;
             white-space : nowrap;
             overflow : hidden;
              text-overflow : ellipsis;
              width:90%;
               color:black;
               font-size:1.05em;
               margin-bottom:0;
            }
            .tabsDiv h5:hover {
            background-color:white;
            }
          
        .BotBorder {
           border-bottom:1px rgba(222, 222, 222, 0.85) solid;
           padding:0px;
           margin-bottom:10px;
        }
            .docs li
             {
                list-style-type:none;
            }
        .BestDocImg {
          height:0px;
        width:0px;
        }

        .CoverImg {
        height:0px;
        width:0px;
        }
        .hee {
        height:205px;
        background:no-repeat center center;
        background-size:cover;
        border:1px white solid;
        }
        .title img{
        height:20px;
        width:30px;
        border:1px white solid;
        }
        .title {
        font-size:1.75em;
         display : inline-block;
             white-space : nowrap;
             overflow : hidden;
              text-overflow : ellipsis;
              width:85%;
        }
       .blink {
    animation-duration: 1s;
    animation-name: blink;
    animation-iteration-count: infinite;
    animation-direction: alternate;
    animation-timing-function: ease-in-out;
    color:white;
    background-color:red;
    font-size:0.5em;
    }
    @@keyframes blink {
   0% {
        opacity: 1;
    }
    80% {
        opacity: 1;
    }
    81% {
        opacity: 0;
    }
    100% {
        opacity: 0;
    }
    }
    .slider_container {
    width:100%;
    height: 100%;
    border: 3px solid;    
    border-color: #fff;
    background-color: #f5f5f5;
    box-shadow: #666 0 0 5px;
    position: relative;

}

.slider_container div {
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0;
    filter: alpha(opacity=0);
}
        .BDtag {
            position: absolute;
            top: 80%;
            left: 60%;
            color: white;
            background: linear-gradient(90deg,black,rgba(0, 0, 0, 0.00));
            width:40%;
            z-index:10;
            padding:10px;
            font-size:2em;
             font-size:1.75em;
          display : inline-block;
             white-space : nowrap;
             overflow : hidden;
        }
        </style>
}
<div class="allPage">
  
   


    <div class="row c1" style="padding:5px;height:500px;margin-bottom:20px">
        <div class="BestDoc col-sm-7 row" id="BestDoc">
          
            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel" style="height:100%;width:100%">
                <!-- Indicators -->
                <ol class="carousel-indicators">
                    @foreach (var item in Model)
                    {
                        int x = 0;
                        foreach (var item2 in item.BestDoc)
                        {
                           <li data-target="#carousel-example-generic" data-slide-to="@x"></li>
                            x = x + 1;
                        }
                        break;
                    }
                  
                </ol>
                <!-- Wrapper for slides -->
                <div class="carousel-inner" style="height:100%;width:100%" role="listbox">
                    @{
                        foreach (var item in Model)
                        {
                            bool flag = true;
                            foreach (var item2 in item.BestDoc)
                            {
                                if (flag)
                                {
                                        <div class="item active ShowDivBG" style="height:100%;width:100%;background-image:url(@Url.Action("GetImage",new { id=item2.theTDoc.DocID})">
                                            <a href="@Url.Action("BlogOne","Main",new { id=item2.theTDoc.DocID})"><div style="height:100%;width:100%"></div></a>
                                              <h3 class="BDtag">@item2.theTDoc.Title</h3>
                                        </div>
                                }
                                else
                                {
                                        <div class="item ShowDivBG" style="height:100%;width:100%;background-image:url(@Url.Action("GetImage",new { id=item2.theTDoc.DocID})">
                                            <a href="@Url.Action("BlogOne","Main",new { id=item2.theTDoc.DocID})"><div style="height:100%;width:100%"></div></a>
                                             <h3 class="BDtag">@item2.theTDoc.Title</h3>
                                        </div>
                                }
                                flag = false;

                            }
                            break;
                        }
                    }
</div>
                <!-- Controls -->
                <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

        </div>
        
        <div class="BlogFunc col-sm-5">
            <h2 style="text-shadow:7px 7px 4px gray"><b>進階搜尋</b></h2>
            <div >
                <form class="text-norr" action="~/Blog/Main/BlogHome" method="post">
                    <div>
                    <input type="text" name="SWord" class="form-group-sm" style="width:70%" placeholder="標題關鍵字" /> <input type="submit" class="btn" value="搜尋"/>
                    </div>
                    <fieldset class="ss1">
                        <legend>地點選擇</legend>
                        <div class="row">
                            @foreach (var item in Model)
                            {
                                foreach (var item2 in item.AllPlace)
                                {
                                    <div class="col-xs-2" >
                                        <a  class="btn place hvr-box-shadow-inset">@item2.PlaceName</a>
                                        <input type="hidden"  name="AllPlace" value="0"  />
                                    </div>
                                }
                                break;
                            }
                        </div>
                    </fieldset>
               
                    <fieldset  class="ss1">
                        <legend>標籤分類</legend>
                        <div class="row">
                            @foreach (var item in Model)
                            {
                                foreach (var item2 in item.AllMood)
                                {
                                    <div class="col-xs-2">
                                        <a class="btn place hvr-box-shadow-inset" style="border-bottom-color:wheat">@item2.MoodName</a>
                                        <input type="hidden" name="AllMood" value="0"  />
                                    </div>
                                }
                                break;
                            }
                        </div>
                    </fieldset>

                    <fieldset class="ss3">
                        <legend>文章時間</legend>
                        <div class="row">
                            <input type="hidden" id="SSTime" name="SSTime"  value="0"/>
                             <div class="col-xs-2">
                                  <a class="SearchD btn hvr-box-shadow-inset">一日內</a>
                             </div>
                            <div class="col-xs-2">
                                <a class="SearchD btn hvr-box-shadow-inset">一週內</a>
                            </div>
                            <div class="col-xs-2">
                                <a class="SearchD btn hvr-box-shadow-inset">一個月內</a>
                            </div>
                            <div class="col-xs-2">
                                <a class="SearchD btn hvr-box-shadow-inset">三個月內</a>
                            </div>
                            <div class="col-xs-2">
                                <a class="SearchD  btn hvr-box-shadow-inset">半年內</a>
                            </div>
                            <div class="col-xs-2">
                                <a class="SearchD  btn hvr-box-shadow-inset">一年內</a>
                            </div>

                        </div>
                    </fieldset>
                    </form>
             </div>
           
        </div>
    </div>
    <div class="row c2">
        <h2>精選分類</h2>
        <div class="ByTagDoc col-sm-8 row" style="height:250px">
                <div class="col-md-3 tabsDiv hvr-box-shadow-outset" id="tabs-1">
                        @foreach (var item in Model)
                        {
                            foreach (var item2 in item.G1Doc)
                            {
                                <h3 class="text-center" style="text-shadow:4px 4px 3px rgba(0, 0, 0, 0.3)"><span class="glyphicon glyphicon-tag"></span>
                                    <b>@item2.theTDoc.Mood.MoodName</b>
                                </h3>
                                break;
                            }
                            break;
                        }
                  
                        @foreach (var item in Model)
                        {
                            foreach (var item2 in item.G1Doc)
                            {
                                <h5>@Html.ActionLink(item2.theTDoc.Title, "BlogOne", new { id = item2.theTDoc.DocID })</h5>
                            }
                            break;
                        }
                  
                </div>
                <div id="tabs-2" class="col-md-3 tabsDiv hvr-box-shadow-outset">
                    @foreach (var item in Model)
                    {
                        foreach (var item2 in item.G2Doc)
                        {
                            <h3  class="text-center" style="text-shadow:4px 4px 3px rgba(0, 0, 0, 0.3)"><span class="glyphicon glyphicon-tag"></span>
                                <b>@item2.theTDoc.Mood.MoodName</b>
</h3>
                            break;
                        }
                        break;
                    }
                  
                        @foreach (var item in Model)
                        {
                            foreach (var item2 in item.G2Doc)
                            {
                                <h5>@Html.ActionLink(item2.theTDoc.Title, "BlogOne", new { id = item2.theTDoc.DocID })</h5>
                            }
                            break;
                        }
                   
                </div>
                <div id="tabs-3" class="col-md-3 tabsDiv hvr-box-shadow-outset">
                    @foreach (var item in Model)
                    {
                        foreach (var item2 in item.G3Doc)
                        {
                            <h3  class="text-center" style="text-shadow:4px 4px 3px rgba(0, 0, 0, 0.3)"><span class="glyphicon glyphicon-tag"></span>
                                <b>@item2.theTDoc.PlaceForBlog.PlaceName</b>
</h3>
                            break;
                        }
                        break;
                    }
             
                        @foreach (var item in Model)
                        {
                            foreach (var item2 in item.G3Doc)
                            {
                                <h5>@Html.ActionLink(item2.theTDoc.Title, "BlogOne", new { id = item2.theTDoc.DocID })</h5>
                            }
                            break;
                        }
                
                </div>
                <div id="tabs-4" class="col-md-3 tabsDiv hvr-box-shadow-outset">
                    @foreach (var item in Model)
                    {
                        foreach (var item2 in item.G4Doc)
                        {
                            <h3  class="text-center" style="text-shadow:4px 4px 3px rgba(0, 0, 0, 0.3)"><span class="glyphicon glyphicon-tag" ></span>
                                <b>@item2.theTDoc.PlaceForBlog.PlaceName</b>
</h3>
                            break;
                        }
                        break;
                    }
                  
                        @foreach (var item in Model)
                        {
                            foreach (var item2 in item.G4Doc)
                            {
                                <h5>@Html.ActionLink(item2.theTDoc.Title, "BlogOne", new { id = item2.theTDoc.DocID })</h5>
                            }
                            break;
                        }
                  
                </div>
        </div>
        <div  style="height:250px" class="ByActUser col-sm-4">
            <div class="text-center" >
                @{
                    MSIT11404project1.Models.MSIT11404Entities db = new MSIT11404project1.Models.MSIT11404Entities();
                    if (Request.Cookies["MemberID"] != null)
                    {
                        int Mid = Convert.ToInt32(Request.Cookies["MemberID"].Value);
                        var theuser = db.Members.Find(Mid);

                      <h2>背包客  @theuser.UserName 你好</h2>
                          <div class="row">
                            <div class="col-lg-4">
                                <img style="height:150px;width:150px;border-radius:50%" src="@Url.Action("GetHeadPic", new { id = Mid })">
                            </div>
                            <div class="col-lg-4">
                                <a href="@Url.Action("Podoc")" class="btn hvr-box-shadow-inset">
                                    <h2>發表文章</h2>
                                    <h2 class="glyphicon glyphicon-pencil"></h2>
                                </a>
                            </div>
                            <div class="col-lg-4">
                                <a href="@Url.Action("MyBlog",new { id = Mid })" class="btn hvr-box-shadow-inset">
                                    <h2>管理文章</h2>
                                    <h2 class="glyphicon glyphicon glyphicon-file"></h2>
                                </a>
                            </div>
                        </div>
                    }
                    else
                    {
                        <h2>訪客您好！</h2>
                        <div class="row">
                            <div class="col-lg-4">
                                <a href="@Url.Action("Login","Member",new { area="Member"})" class="btn">
                                    <h2>登入</h2>
                                    <h2 class="glyphicon glyphicon-pencil"></h2>
                                </a>
                            </div>
                        </div>
                    }

                }
            </div>
        </div>
    </div>
    <div>
        <nav class="navbar navbar-default" style="background-color:rgba(255, 211, 0, 0.80)">
            <div class="container-fluid">
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        @for (int i = 1; i < ViewBag.TotalPage + 1; i++)
                        {
                            <li><a class="hvr-box-shadow-inset"  href="@Url.Action("BlogHome", new { page = i ,numby= ViewBag.NumBy })">@i</a></li>
                        }
                    </ul>
                    <form class="navbar-form navbar-right" >
                        <div class="form-group">
                            <label>顯示比數 </label>
                            <select class="form-control"  name="numby" >
                                <option value="10">10</option>
                                <option value="20">20</option>
                                <option value="30">30</option>
                            </select>
                            <label>頁數  </label><input style="width:180px" name="page" type="number" min="1" max="@ViewBag.TotalPage" class="form-control" placeholder="頁數搜尋">
                        </div>
                      <input type="submit"  value="前往"/>
                    </form>
            
                </div>
            </div>
        </nav>

    </div>
    <div class="text-center row">
        <h4><b>目前顯示：第  @ViewBag.TruePage 頁 / 每頁：@ViewBag.Numby 筆文章</b></h4>
        @foreach (var item in Model)
        {<div class="bgg hvr-bob">
        <a class="divlink" href="@Url.Action("BlogOne", new { id = item.Docid })">
            <div class="text-center docs col-md-2">
                <div class="text-center BotBorder">
                    <div class="hee">
                        <img class="CoverImg" src="@Url.Action("GetImage",new { id=item.Docid})" />
                        <span class="tag1">@item.PlaceName</span>
                        <span class="tag2">@item.MoodName</span>
                    </div>
                </div>
                <div class="BotBorder text-left">
                    <ul>
                        <li><span class="title">@Html.Raw(item.imgNew) @item.Title</span></li>
                    </ul>
                </div>
                <div class="row">
                    <div class="col-lg-6 text-left"><img style="width:30px;height:30px;border-radius:50%" src="@Url.Action("GetHeadPic",new { id=item.Mid})"/>@item.UserName</div>
                </div>
                <div>
                    <div class="text-left">@item.CreateTime</div>
                </div>
                <div class="row">
                    <div class="col-lg-6 text-left">瀏覽數：@item.Good</div>
                    <div class="col-lg-6  text-right">留言數：@item.TotalMSG</div>
                </div>
            </div>
        </a>
    </div>
        }
    </div>
</div>
<div class="text-center">
    <h4><b>目前顯示：第  @ViewBag.TruePage 頁 / 每頁：@ViewBag.Numby 筆文章</b></h4>
</div>
<div>
    <nav class="navbar navbar-default text-center" style="background-color:rgba(255, 211, 0, 0.80)">
        <div class="container-fluid">
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    @for (int i = 1; i < ViewBag.TotalPage + 1; i++)
                    {
                        <li><a class="hvr-box-shadow-inset" href="@Url.Action("BlogHome", new { page = i ,numby= ViewBag.NumBy })">@i</a></li>
                    }
                </ul>
            </div>
        </div>
    </nav>
</div>

@section script{
    <script>
     




        //文章搜尋區的標籤設定
        var Sbtns = $("fieldset[class='ss1'] a[class*=btn]");
        var Tbtns = $("fieldset[class='ss3'] a[class*='btn']");
        Sbtns.siblings("input").val("0");
        $("#SSTime").val("0");

        Sbtns.addClass("Ncheck")
        Tbtns.addClass("Ncheck")
        Sbtns.click(function () {
            var V = $(this).siblings("input");
            var A = $(this);
            if (V.val() == "0") {
                V.val(A.text())
                A.removeClass("Ncheck").addClass("Ycheck")
            }
            else {
                V.val("0");
                A.removeClass("Ycheck").addClass("Ncheck")
            }
        })

        Tbtns.click(function () {
            var V = $("#SSTime");
            var A = $(this);
            V.val(A.text());
            Tbtns.removeClass("Ycheck");
            Tbtns.addClass("Ncheck")
            A.removeClass("Ncheck")
            A.addClass("Ycheck")
        })

        //處理每一篇文章封面圖片>>>>>>
        $("div[class*='hee']").each(function () {
            var gg = $(this).find("img[class*='CoverImg']").attr("src");
            $(this).css("background-image", "url(" + gg + ")")
        })
        //處理每一篇文章封面圖片======
      

        //輪播精選文章>>>>
        timego = setInterval(changeIMG, 2000);
        ImgN = 0;
        var areas = document.getElementById("BestDoc"); //BD顯示區的整個Div 
        var BestDocImgs = document.querySelectorAll(".BestDocImg"); //藏著的5張圖片
        var BDa = document.querySelectorAll(".BDa"); //所有li裡面的5個A
        var BDon = document.getElementById("BDon"); //正被播到的A 變成一個連結在左邊
        changeIMG()
     
        var settime = document.getElementById("BestDoc")
        settime.onmouseover = function () { clearInterval(timego); }
        settime.onmouseout = function () { timego = setInterval(changeIMG, 2000); }
   
        var BDtitle = document.querySelectorAll("BDtitle");
        for (var i = 0; i < BDtitle.length; i++) {
            BDtitle[i].onmouseover = function () {
                BDon.href = $(this).children("a").attr("href")
                this.style.color = "green";
            }
            BDtitle[i].onmouseout = function () {
                BDon.href = $(this).children("a").attr("href")
                this.style.color = "black";
            }
        }
        function changeIMG() {
            $("ul[class='BDTs'] a").css("color", "black");
            if (ImgN < 4)
            {
                ImgN += 1;
            }
            else
            {
                ImgN = 0;
            }
            var BDImgtmp = BestDocImgs[ImgN].getAttribute("src");
            BDon.href = BDa[ImgN].href;
            areas.style.cssText = "background-image:url(" + BDImgtmp + ")";

            BDa[ImgN].style.cssText = "color:green";
        }
        //輪播精選文章============

    </script>
    
    
    }